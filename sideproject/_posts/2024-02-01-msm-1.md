---
title: "프로젝트에 적합한 패키지 모듈화"
excerpt: "상황에 맞는 적합한 패키지 구조를 잡아보자"
categories:
    - MSM 
tags:
toc: true
toc_sticky: true
toc_label: 목차
toc_icon: "cog"
# classes: wide
header:
#   teaser: /assets/images/2022-03-28/the_pragmatic_programmer.jpeg
---
## 들어가며
<figure>
<img src='https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CAotacFcEKIO7aY97tcb5Q.png'>
  <figcaption><a href="https://medium.com/sahibinden-technology/package-by-layer-vs-package-by-feature-7e89cde2ae3a">Package by Layer vs Package by Feature </a></figcaption>
</figure>

요구사항을 정리하고 구현할 차례
내 사이드 프로젝트에 적합한 구조는 뭘까?
내 프로젝트의 규모는 이렇고 상황은 이러이러하며 ~~ 이러할꺼라 가정한다.

패키지 모듈화는 크게 두가지 접근법이 있다.

## 레이어에 따른 패키지 구조
```
app
├── controller
│   ├── OrderController
│   ├── ProductController
│   └── ...
├── model
│   ├── Order
│   ├── Product
│   └── ...
├── service
│   ├── OrderService
│   ├── ProductService
│   └── ...
└── repository
    ├── OrderRepository
    ├── ProductRepository
    └── ...
```
코드를 계층별로 나눠 코드가 시스템에 어떻게 들어맞는지를 나타낸다.

### 장점
- 소규모 프로젝트에 적합.
- 처음 시작하는 사람도 클래스를 추가하기 쉽다.

### 단점
- 프로젝트가 커지면 더 많은 기능을 통합하게 되면서 복잡성이 증가한다.
- 캡슐화 측면에서 불리하다. 연관이 있는 클래스들이 레이어에 따라 나눠지므로 public으로 열어야 한다.


## 기능에 따른 패키지 구조
```
app
├── order
│   ├── OrderController
│   ├── OrderService
│   └── OrderRepository
└── product
    ├── ProductController
    ├── ProductService
    └── ProductRepository
```
기능별로 패키지를 묶어 그 안에 다양한 컴포넌트와 모듈을 구성한다.

### 장점
- monolith 서비스에서 각 팀별로 서로 다른 모듈을 작업함으로써 팀간의 충돌과 종속성을 줄일 수 있다.
    - 기존 기능을 추출해서 microservice로 전환하기에도 유리하다.
- 기능별로 묶여 있기 때문에 외부에 노출해야하는 기능만 public으로 열 수 있다 ➡️ 캡슐화 사용

### 단점
- 기능이 많아지면 패키지 수 또한 많아진다
- 새로운 클래스를 추가할 때 어떤 패키지에 들어갈 지 정확히 알아야 한다. ➡️ 새로운 사람이 작업하기에 어렵다

## 응집도와 결합도
<figure>
  <img src='https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Gp2CkZKaj_myY9srSWaiQ.jpeg'>
  <figcaption>응집도와 결합도</figcaption>
</figure>

> 핵심은 서로 연관이 있는 컴포넌트끼리는 가깝게, 관련 없는 컴포넌트는 멀리 배치한다

## 내가 선택한 패키지 구조
<figure>
  <img src='https://github.com/grey920/grey920.github.io/assets/58028215/4a60e01a-a710-4af0-9000-26dda44ac1ab'>
  <figcaption>두 형식을 결합한 MusicSoulmate 패키지 구조</figcaption>
</figure>

하이브리드. 공통 부분은 레이어, 기능 관련은 따로 모듈화.
- 공통 처리( layer based ) : 공통으로 사용하거나 외부 모듈인 경우
    - util, config, security
- 기능별 모듈
    - member: domain, service, web, exception으로 분리. 그 안에서도 서로 연관이 높은 컴포넌트끼리 묶는다. entity와 repository는 domain의 하위로 묶고, dto와 controller는 web으로 묶는다.

## 결론
['은탄환은 없다'](https://ko.wikipedia.org/wiki/%EC%9D%80%EB%B9%9B_%EC%B4%9D%EC%95%8C%EC%9D%80_%EC%97%86%EB%8B%A4)는 [프레더릭 브룩스](https://ko.wikipedia.org/wiki/%ED%94%84%EB%A0%88%EB%8D%94%EB%A6%AD_%EB%B8%8C%EB%A3%A9%EC%8A%A4)의 말처럼 모든 상황에 맞는 하나의 완벽한 해답은 없다.
이번에 패키지 구조 설계에 대해 알아보면서 앞으로 프로젝트를 시작할 때 현재 상황에 맞는 방식이 무엇인지 조금은 명확하게 알고 시작할 수 있을 것 같다.